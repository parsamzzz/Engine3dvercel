<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>تست تولید ویدیو Veo</title>
  <style>
    body { font-family: sans-serif; background: #121212; color: #fff; padding: 20px; }
    input, select, button { margin: 5px 0; display: block; }
    video { margin-top: 20px; max-width: 100%; }
  </style>
</head>
<body>
  <h1>تست تولید ویدیو Veo</h1>

  <form id="videoForm">
    <label>مدل:</label>
    <select name="model" required>
      <option value="veo-2.0">veo-2.0</option>
      <option value="veo-3.0">veo-3.0</option>
      <option value="veo-3.0-fast">veo-3.0-fast</option>
      <option value="veo-3.1">veo-3.1</option>
      <option value="veo-3.1-fast">veo-3.1-fast</option>
    </select>

    <label>Prompt:</label>
    <input type="text" name="prompt" required>

    <label>Resolution:</label>
    <select name="resolution">
      <option value="720p">720p</option>
      <option value="1080p">1080p</option>
    </select>

    <label>Duration (seconds):</label>
    <input type="number" name="duration" min="4" max="8" value="4">

    <label>Aspect Ratio:</label>
    <input type="text" name="aspectRatio" placeholder="16:9">

    <label>Negative Prompt:</label>
    <input type="text" name="negativePrompt">

    <label>Use Reference Images:</label>
    <select name="useReferenceImages">
      <option value="false">خیر</option>
      <option value="true">بله</option>
    </select>

    <label>Use Interpolation:</label>
    <select name="useInterpolation">
      <option value="false">خیر</option>
      <option value="true">بله</option>
    </select>

    <label>Use Extension (video input):</label>
    <select name="useExtension">
      <option value="false">خیر</option>
      <option value="true">بله</option>
    </select>

    <label>Upload Images (max 3):</label>
    <input type="file" name="image" multiple accept="image/*">

    <label>Upload Video (for extension):</label>
    <input type="file" name="video" accept="video/*">

    <button type="submit">Generate Video</button>
  </form>

  <video id="resultVideo" controls style="display:none;"></video>

  <script>
    const form = document.getElementById('videoForm');
    const resultVideo = document.getElementById('resultVideo');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      resultVideo.style.display = 'none';

      const formData = new FormData(form);

      try {
        const response = await fetch('https://engine3dvercel.onrender.com/api/veo/generate-video', {
          method: 'POST',
          body: formData
        });

        if (!response.ok) {
          const err = await response.json();
          alert("خطا: " + (err.error || "Unknown error"));
          return;
        }

        const blob = await response.blob();
        resultVideo.src = URL.createObjectURL(blob);
        resultVideo.style.display = 'block';
        resultVideo.play();

      } catch (err) {
        console.error(err);
        alert("خطا در ارسال درخواست.");
      }
    });
  </script>
</body>
</html>
